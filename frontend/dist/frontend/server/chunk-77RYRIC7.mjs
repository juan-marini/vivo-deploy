import './polyfills.server.mjs';
import{a as f,c as h,d as U}from"./chunk-TJ446NKF.mjs";import{O as m,Oa as j,P as C,Qa as E,Wa as I,X as T,Z as w,a as d,ba as F,c as O,ca as p,da as l,ea as S,ib as L,ja as k,jb as $,la as g,lb as z,m as P,ma as y,p as x,t as _,ta as A}from"./chunk-NOQO3GIZ.mjs";import{a as u,b as v}from"./chunk-VVCT4QZE.mjs";function N(c,B){if(c&1&&(p(0,"a",15),S(1,"i"),p(2,"span"),g(3),l()()),c&2){let t=B.$implicit;w("routerLink",t.route),m(),F(t.icon),m(2),y(t.label)}}var q=(()=>{class c{constructor(t,e){this.userProfileService=t,this.authService=e,this.welcomeMessage="",this.navigationItems=[]}ngOnInit(){this.welcomeMessage=this.userProfileService.getWelcomeMessage(),this.navigationItems=this.userProfileService.getNavigationItems()}onLogout(){this.authService.logout()}static{this.\u0275fac=function(e){return new(e||c)(C(U),C(h))}}static{this.\u0275cmp=_({type:c,selectors:[["app-header"]],standalone:!0,features:[A],decls:20,vars:2,consts:[[1,"header"],[1,"header-container"],[1,"brand-section"],[1,"vivo-brand"],[1,"vivo-logo"],[1,"logo-text"],[1,"brand-info"],[1,"welcome-title"],[1,"system-subtitle"],[1,"nav-section"],[1,"main-navigation"],["class","nav-item","routerLinkActive","nav-item--active",3,"routerLink",4,"ngFor","ngForOf"],[1,"user-actions"],[1,"logout-btn",3,"click"],[1,"fas","fa-sign-out-alt"],["routerLinkActive","nav-item--active",1,"nav-item",3,"routerLink"]],template:function(e,o){e&1&&(p(0,"header",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"span",5),g(6,"VIVO"),l()(),p(7,"div",6)(8,"h1",7),g(9),l(),p(10,"span",8),g(11,"Sistema de Onboarding"),l()()()(),p(12,"div",9)(13,"nav",10),T(14,N,4,4,"a",11),l(),p(15,"div",12)(16,"button",13),k("click",function(){return o.onLogout()}),S(17,"i",14),p(18,"span"),g(19,"Sair"),l()()()()()()),e&2&&(m(9),y(o.welcomeMessage),m(5),w("ngForOf",o.navigationItems))},dependencies:[E,j,z,L,$],styles:['[_ngcontent-%COMP%]:root{--vivo-purple: #660099;--vivo-purple-light: #7A1CA3;--vivo-purple-dark: #4D0073;--vivo-purple-gradient: linear-gradient(135deg, #660099 0%, #7A1CA3 100%);--white: #FFFFFF;--gray-50: #F8FAFC;--gray-100: #F1F5F9;--gray-200: #E2E8F0;--gray-300: #CBD5E1;--gray-400: #94A3B8;--gray-500: #64748B;--gray-600: #475569;--gray-700: #334155;--gray-800: #1E293B;--gray-900: #0F172A;--success: #10B981;--success-light: #34D399;--warning: #F59E0B;--warning-light: #FBBF24;--error: #EF4444;--error-light: #F87171;--info: #3B82F6;--info-light: #60A5FA;--shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, .05);--shadow-md: 0 4px 6px -1px rgba(0, 0, 0, .1), 0 2px 4px -1px rgba(0, 0, 0, .06);--shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, .1), 0 4px 6px -2px rgba(0, 0, 0, .05);--shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, .1), 0 10px 10px -5px rgba(0, 0, 0, .04);--border-radius-sm: 4px;--border-radius-md: 8px;--border-radius-lg: 12px;--border-radius-xl: 16px;--font-weight-normal: 400;--font-weight-medium: 500;--font-weight-semibold: 600;--font-weight-bold: 700;--spacing-xs: 4px;--spacing-sm: 8px;--spacing-md: 16px;--spacing-lg: 24px;--spacing-xl: 32px;--spacing-2xl: 48px}.header[_ngcontent-%COMP%]{background:linear-gradient(135deg,#fff,#f8fafc);border-bottom:1px solid var(--gray-200);box-shadow:0 2px 8px #66009914;position:sticky;top:0;z-index:1000}.header-container[_ngcontent-%COMP%]{max-width:1400px;margin:0 auto;padding:0 var(--spacing-lg);display:flex;justify-content:space-between;align-items:center;height:72px}.brand-section[_ngcontent-%COMP%]{display:flex;align-items:center}.vivo-brand[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--spacing-md)}.vivo-logo[_ngcontent-%COMP%]{background:var(--vivo-purple-gradient);border-radius:var(--border-radius-md);padding:10px 16px;box-shadow:var(--shadow-md);position:relative;overflow:hidden}.vivo-logo[_ngcontent-%COMP%]:before{content:"";position:absolute;inset:0;background:linear-gradient(135deg,rgba(255,255,255,.2) 0%,transparent 100%);pointer-events:none}.vivo-logo[_ngcontent-%COMP%]   .logo-text[_ngcontent-%COMP%]{color:var(--white);font-weight:var(--font-weight-bold);font-size:18px;letter-spacing:1px;text-shadow:0 1px 2px rgba(0,0,0,.1)}.brand-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2px}.welcome-title[_ngcontent-%COMP%]{color:var(--gray-800);font-size:18px;font-weight:var(--font-weight-semibold);margin:0;line-height:1.2}.system-subtitle[_ngcontent-%COMP%]{color:var(--gray-500);font-size:13px;font-weight:var(--font-weight-medium);text-transform:uppercase;letter-spacing:.5px}.nav-section[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--spacing-xl)}.main-navigation[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--spacing-sm)}.nav-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--spacing-sm);padding:10px 16px;border-radius:var(--border-radius-md);color:var(--gray-600);font-weight:var(--font-weight-medium);font-size:14px;text-decoration:none;transition:all .2s cubic-bezier(.4,0,.2,1);position:relative}.nav-item[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:16px;width:18px;text-align:center}.nav-item[_ngcontent-%COMP%]:hover{color:var(--vivo-purple);background:#6600990d;transform:translateY(-1px)}.nav-item--active[_ngcontent-%COMP%]{color:var(--vivo-purple);background:#66009914;font-weight:var(--font-weight-semibold)}.nav-item--active[_ngcontent-%COMP%]:before{content:"";position:absolute;bottom:-1px;left:16px;right:16px;height:2px;background:var(--vivo-purple-gradient);border-radius:1px}.user-actions[_ngcontent-%COMP%]{display:flex;align-items:center}.logout-btn[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--spacing-sm);padding:10px 20px;background:transparent;border:1.5px solid var(--gray-300);border-radius:var(--border-radius-md);color:var(--gray-700);font-weight:var(--font-weight-medium);font-size:14px;cursor:pointer;transition:all .2s cubic-bezier(.4,0,.2,1)}.logout-btn[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:16px}.logout-btn[_ngcontent-%COMP%]:hover{border-color:var(--vivo-purple);color:var(--vivo-purple);background:#66009908;transform:translateY(-1px);box-shadow:var(--shadow-sm)}.logout-btn[_ngcontent-%COMP%]:active{transform:translateY(0)}@media (max-width: 768px){.header-container[_ngcontent-%COMP%]{padding:0 var(--spacing-md);height:64px}.vivo-brand[_ngcontent-%COMP%]{gap:var(--spacing-sm)}.welcome-title[_ngcontent-%COMP%]{font-size:16px}.system-subtitle[_ngcontent-%COMP%]{font-size:11px}.nav-section[_ngcontent-%COMP%]{gap:var(--spacing-md)}.main-navigation[_ngcontent-%COMP%]{gap:var(--spacing-xs)}.nav-item[_ngcontent-%COMP%]{padding:8px 12px;font-size:13px}.nav-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:none}.nav-item[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:18px}.logout-btn[_ngcontent-%COMP%]{padding:8px 12px}.logout-btn[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:none}.logout-btn[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:18px}}']})}}return c})();var Z=(()=>{class c{constructor(t,e){this.http=t,this.authService=e,this.topicsSubject=new O([]),this.topics$=this.topicsSubject.asObservable(),this.clearAllStoredData(),this.loadTopicsFromApi()}getTopics(){return this.topics$}getTopicById(t){return new d(e=>{let o=this.topics$.subscribe(i=>{let a=i.find(r=>r.id===t)||null;e.next(a)});return()=>o.unsubscribe()})}markTopicAsCompleted(t,e){let o=this.authService.currentUserValue,i=e||o?.email;if(!i){console.error("\u274C Usu\xE1rio n\xE3o encontrado para salvar progresso");return}let a=this.topicsSubject.value,r=a.map(n=>n.id===t?v(u({},n),{isCompleted:!0}):n);this.topicsSubject.next(r),this.saveTopicsToStorage(r,e);let s=`${f.apiUrl}/progress/member/${i}/topic/${t}/complete`;this.http.post(s,{}).subscribe({next:n=>{console.log("\u2705 Progresso salvo no banco de dados:",n)},error:n=>{console.error("\u274C Erro ao salvar progresso no banco:",n);let M=a.map(b=>b.id===t?v(u({},b),{isCompleted:!1}):b);this.topicsSubject.next(M),this.saveTopicsToStorage(M,e)}})}getCompletionStats(t){let e=this.topicsSubject.value,o=e.filter(r=>r.isCompleted).length,i=e.length,a=i>0?Math.round(o/i*100):0;return{completed:o,total:i,percentage:a}}getCompletionStatsForUser(t){let e=this.loadTopicsFromStorage(t),o=e.filter(r=>r.isCompleted).length,i=e.length,a=i>0?Math.round(o/i*100):0;return{completed:o,total:i,percentage:a}}resetAllTopics(){let e=this.topicsSubject.value.map(o=>v(u({},o),{isCompleted:!1}));this.topicsSubject.next(e),this.saveTopicsToStorage(e)}loadTopicsFromStorage(t){if(typeof window<"u"&&window.localStorage)try{let e=t?`topics_${t}`:"topics",o=localStorage.getItem(e);if(o)return JSON.parse(o)}catch(e){console.error("Error loading topics from storage:",e)}return this.topicsSubject.value}saveTopicsToStorage(t,e){if(typeof window<"u"&&window.localStorage)try{let o=e?`topics_${e}`:"topics";localStorage.setItem(o,JSON.stringify(t))}catch(o){console.error("Error saving topics to storage:",o)}}loadUserTopics(t){let e=this.loadTopicsFromStorage(t);this.topicsSubject.next(e)}getAllTopicsForUser(t){return this.loadTopicsFromStorage(t).map(o=>({topicId:o.id,topicTitle:o.title,category:o.category,estimatedTime:o.estimatedTime,isCompleted:o.isCompleted,completedDate:o.isCompleted?new Date().toISOString().split("T")[0]:void 0,timeSpent:o.isCompleted?o.estimatedTime:void 0}))}getTopicsByCategory(t){return new d(e=>{let o=this.topics$.subscribe(i=>{let a=i.filter(r=>r.category.toLowerCase()===t.toLowerCase());e.next(a)});return()=>o.unsubscribe()})}getAvailableCategories(){return new d(t=>{let e=this.topics$.subscribe(o=>{let i=[...new Set(o.map(a=>a.category))];t.next(i.sort())});return()=>e.unsubscribe()})}searchTopics(t,e){return new d(o=>{let i=this.topics$.subscribe(a=>{let r=a;if(e&&e!=="all"&&(r=r.filter(s=>s.category.toLowerCase()===e.toLowerCase())),t&&t.trim()!==""){let s=t.toLowerCase();r=r.filter(n=>n.title.toLowerCase().includes(s)||n.description.toLowerCase().includes(s)||n.category.toLowerCase().includes(s))}o.next(r)});return()=>i.unsubscribe()})}loadTopicsFromApi(){let t=this.authService.currentUserValue;if(!t?.email){console.log("\u23F3 Aguardando usu\xE1rio estar logado para carregar t\xF3picos..."),setTimeout(()=>this.loadTopicsFromApi(),1e3);return}let e=`${f.apiUrl}/progress/topics`,o=`${f.apiUrl}/progress/member/${t.email}`;this.http.get(e).subscribe({next:i=>{this.http.get(o).subscribe({next:a=>{let r=new Map;a&&a.topicsProgress&&a.topicsProgress.forEach(n=>{r.set(n.topicId,n.isCompleted)});let s=i.map(n=>({id:n.id,title:n.title,description:n.description,category:n.category,estimatedTime:n.estimatedTime,isCompleted:r.get(n.id)||!1,documents:n.documents||[],links:n.links||[],contacts:n.contacts||[]}));console.log("\u{1F50D} Dados completos carregados:",s),console.log("\u{1F4C4} Exemplo de t\xF3pico 3:",s.find(n=>n.id===3)),this.topicsSubject.next(s),console.log(`\u2705 ${s.length} t\xF3picos carregados com documentos, links e contatos`)},error:a=>{console.log("\u26A0\uFE0F Erro ao carregar progresso, usando t\xF3picos sem progresso:",a);let r=i.map(s=>({id:s.id,title:s.title,description:s.description,category:s.category,estimatedTime:s.estimatedTime,isCompleted:!1,documents:s.documents||[],links:s.links||[],contacts:s.contacts||[]}));this.topicsSubject.next(r),console.log(`\u2705 ${r.length} t\xF3picos carregados sem progresso espec\xEDfico`)}})},error:i=>{console.error("\u274C Erro ao carregar t\xF3picos da API:",i),this.topicsSubject.next([])}})}clearAllStoredData(){if(typeof window<"u"&&window.localStorage)try{Object.keys(localStorage).forEach(e=>{(e.startsWith("topics")||e.includes("progress")||e.includes("topic"))&&localStorage.removeItem(e)}),console.log("\u{1F9F9} Dados mocados do localStorage foram limpos")}catch(t){console.error("Error clearing stored data:",t)}}static{this.\u0275fac=function(e){return new(e||c)(x(I),x(h))}}static{this.\u0275prov=P({token:c,factory:c.\u0275fac,providedIn:"root"})}}return c})();export{q as a,Z as b};
